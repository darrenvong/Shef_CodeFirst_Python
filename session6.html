---
layout: slide
title: "Session 6: Deploying your code"
description: Sharing your app with the world
image_url: "/assets/session6_slide.png"
css: "/css/session6.css"
---
<section>
  <h2> Session 6: Deploying your code </h2>
  <p>
      Sharing <strong>your app</strong> with the world
  </p>
  <img src="./assets/heroku.png" alt="heroku">
  <!-- <p class='author'> Darren Vong
    <br>
    <a href="http://twitter.com/mrdarrenv" target="_blank">
      <i class="fa fa-twitter" aria-hidden="true">
      </i> @mrdarrenv
    </a>
  </p> -->
</section>

<section>
  <h2> Where can I find the material? </h2>
  You can find all the slides, links to the curriculum, and
  to the GitHub repository at:
  <br>
  <br>
  <p class='fragment grow'>
    <a href="https://darrenvong.github.io/shefcodefirst-python/">
      https://darrenvong.github.io/shefcodefirst-python/</a></p>
</section>

<section>
  <h3>
    <i class="fa fa-reply" aria-hidden="true"></i>
    Recap: What is an API?
  </h3>
  <ul>
    <li>A way which allows our Python code to access external services <strong>programmatically</strong>.</li>
    <li>Think of it as the "user interface" for our code to interact with a service!</li>
    <li>
      This interface allows our Python code to <strong>collect and process data</strong> from these
      services <strong>more easily</strong>.
    </li>
  </ul>
</section>

<section>
  <h3>
    <i class="fa fa-reply" aria-hidden="true"></i>
    Recap: communicating with API in Python
  </h3>
  <p>We can do that either using:</p>
  <ul>
    <li class="fragment"><strong>requests</strong> (HTTP for humans) with our chosen API, or;</li>
    <li class="fragment">
      a Python library (like <strong>tweepy</strong>) which defines various <strong>functions
      that we can use</strong> in our code to access the API.
    </li>
    <li class="fragment">Here's the familiar diagram again...</li>
  </ul>
</section>

<section>
  <div style="position:relative;">
    <img src="assets/req_res_cycle.png" alt="The Request-Response Cycle">
    <img id="python" src="assets/python_logo.jpg" alt="python code">
    <strong>
      <p id="req-url" class="fragment">http://api.openweathermap.org/data/2.5/weather</p>
    </strong>
    <div id="res" class="fragment">
      <strong data-markdown>
        ```json
        {
          "clouds": {"all": 92},
          ...
        }
        ```
      </strong>
    </div>
  </div>
</section>

<section>
  <h3>
    <i class="fa fa-reply" aria-hidden="true"></i>
    Recap: API keys
    <i class="fa fa-key" aria-hidden="true"></i>
  </h3>
  <ul>
    <li>
      Used by most services that provide an API to identify who is accessing it.
    </li>
    <li>Authenticates our app and gives us permission to access the API accordingly.</li>
    <li class="fragment highlight-red">
      <strong>NEVER</strong> commit your keys on GitHub - it's the equivalent of giving away
      your passwords to everyone!
    </li>
  </ul>
</section>

<section>
  <h3>And now...</h3>
  <p>Let's move on to the course's final major topic: <strong>deployment</strong>!</p>
</section>

<section>
  <h3>
    <i class="fa fa-cloud-upload"></i>
    Why should we upload (deploy) our app?
  </h3>
  <ul>
    <li>
      Up until now, we've been working on and running the website <strong>locally</strong>
      on our laptops.
    </li>
    <li class="fragment">
      This means the rest of the world won't be able to see the <strong>awesome work</strong>
      we have done!
    </li>
    <li class="fragment">
      By <strong>deploying</strong> our code to a cloud-based platform (<strong>Heroku</strong>
      is the one we'll be using), our app will be assigned a publicly accessible URL that others
      can visit to see it!
    </li>
  </ul>
</section>

<section>
  <h3>What is Heroku?</h3>
  <ul id="heroku-list">
    <li>
      A <strong>cloud-based platform </strong> where we can push our code online to get our
      flask app up and running.
    </li>
    <li class="fragment">
      Since one of the main purposes of computers on a cloud-based platform is to <strong>listen
      out to user requests</strong> at all times, it's on 24/7 unlike our laptops.
    </li>
    <li class="fragment">
      Using Heroku also means that if our app becomes super popular, we can
      easily <strong>add more computing power</strong> to the platform our app runs on without the need to
      switch to a different one.
    </li>
  </ul>
</section>

<section>
  <h3>
    <i class="fa fa-cogs" aria-hidden="true"></i>
    Hands on: deploying our first app to Heroku
  </h3>
  <p class="fragment grow">
    <a href="https://github.com/darrenvong/shefcodefirst-python/blob/master/deploy-to-heroku.md" target="_blank">
      Check out the step-by-step guide here
    </a>
  </p>
</section>

<section>
  <h3>Summary of changes to our local project</h3>
  <ul>
    <li>create Procfile</li>
    <li>create requirenments.txt</li>
    <li data-markdown>in our app `import os`</li>
    <li data-markdown>in our app replace `app.run(debug=True)`</li>
    <li>commit and push our changes to github!</li>
  </ul>
</section>

<section>
  <h3>Config (environment) variables</h3>
  <p>
    Instead of storing our API keys in a .env file, Heroku lets us store our API keys in
    <strong>config variables instead.</strong>
  </p>
  <p class="fragment">
    The values of these config variables can be set in our app on the Heroku website under
    <strong>Settings > Config Variables</strong>, then click the <strong>Reveal Config Vars</strong> button.
  </p>
</section>

<section>
  <img src="assets/heroku_settings.png" alt="Heroku settings">
</section>

<section>
  <p>And here's how we'd access the values in our Python code:</p>
  <div class="full-width" data-markdown>
    ```python
    import os
    import tweepy
    from dotenv import load_dotenv

    load_dotenv()

    consumer_key = os.getenv("twitter_consumer_key")
    consumer_secret = os.getenv("twitter_consumer_secret")
    auth = tweepy.OAuthHandler(consumer_key, consumer_secret)
    ...
    ```
  </div>
</section>

<section>
  <h3><i class="fa fa-bug"></i>
    Debugging our deployed app
  </h3>
  <p>
    When we develop our app locally on our laptops, we can normally <strong>trace any errors</strong>
    our app may have by looking at the terminal where we started up our Flask app. 
  </p>
  <p class="fragment">
    The same set of errors may be accessed by clicking the <strong>More</strong> button at the top right
    of your app's dashboard. Then, select <strong>View logs</strong> in the dropdown.
  </p>
</section>

<section>
  <img src="assets/error_logs_dropdown.png" alt="Error logs dropdown">
  <small><strong>The dropdown menu to click to reach the error logs</strong></small>
  <hr>
  <img src="assets/error_logs.png" alt="Error logs">
  <small><strong>What the actual error logs look like</strong></small>
</section>
